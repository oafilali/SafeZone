<!DOCTYPE html>
<html>
<head>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 0; }
        .header { background-color: #dc3545; color: white; padding: 20px; text-align: center; }
        .content { margin: 20px; }
        .alert { background-color: #f8d7da; border: 2px solid #f5c6cb; padding: 15px; border-radius: 5px; margin: 15px 0; color: #721c24; }
        .section { margin: 20px 0; padding: 15px; background-color: #fff3cd; border-left: 5px solid #dc3545; }
        .section-title { font-weight: bold; color: #dc3545; font-size: 16px; }
        .error-badge { display: inline-block; background-color: #dc3545; color: white; padding: 5px 10px; border-radius: 3px; margin-right: 10px; }
        table { border-collapse: collapse; width: 100%; margin-top: 10px; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background-color: #dc3545; color: white; }
        tr:nth-child(even) { background-color: #fafafa; }
        .action-box { background-color: #e7f3ff; border-left: 5px solid #0066cc; padding: 15px; margin: 15px 0; }
        .footer { margin-top: 30px; padding-top: 20px; border-top: 2px solid #ddd; font-size: 12px; color: #666; text-align: center; }
        a { color: #007bff; text-decoration: none; }
        a:hover { text-decoration: underline; }
        ol { margin: 10px 0; padding-left: 20px; }
        li { margin: 8px 0; }
    </style>
</head>
<body>
    <div class="header">
        <h1>‚ùå Build Failed</h1>
        <p>Build #${BUILD_NUMBER} encountered errors</p>
    </div>
    
    <div class="content">
        <div class="alert">
            <strong>‚ö†Ô∏è ATTENTION REQUIRED</strong><br/>
            The CI/CD pipeline has failed. Immediate investigation and action is needed.
        </div>
        
        <div class="section">
            <p><span class="section-title">üìã Build Information</span></p>
            <table>
                <tr><th>Build Number</th><td><span class="error-badge">#${BUILD_NUMBER}</span></td></tr>
                <tr><th>Job Name</th><td>${JOB_NAME}</td></tr>
                <tr><th>Build Status</th><td><span class="error-badge">FAILED</span></td></tr>
                <tr><th>Failed At</th><td>See console output for details</td></tr>
                <tr><th>Duration</th><td>${BUILD_DURATION}</td></tr>
                <tr><th>Timestamp</th><td>${BUILD_TIMESTAMP}</td></tr>
                <tr><th>Git Branch</th><td>${GIT_BRANCH}</td></tr>
            </table>
        </div>
        
        <div class="section">
            <p><span class="section-title">üî¥ Possible Failure Causes</span></p>
            <ul>
                <li><strong>Test Failures:</strong> JUnit or Jasmine/Karma tests failed</li>
                <li><strong>Compilation Errors:</strong> Build compilation failed</li>
                <li><strong>Deployment Issues:</strong> Deployment or health checks failed</li>
                <li><strong>Environment Problems:</strong> Missing dependencies or configuration issues</li>
            </ul>
        </div>
        
        <div class="action-box">
            <p><span class="section-title">üõ†Ô∏è Required Actions (In Order)</span></p>
            <ol>
                <li><strong>View Console Output:</strong> Click the link below to see detailed error messages</li>
                <li><strong>Check Test Report:</strong> Review which tests failed and why</li>
                <li><strong>Review Code Changes:</strong> Check recent Git commits for problematic changes</li>
                <li><strong>Fix Issues:</strong> Make necessary fixes to the code</li>
                <li><strong>Commit and Push:</strong> Push fixes to trigger a new build</li>
                <li><strong>Monitor Next Build:</strong> Watch the new build to confirm it passes</li>
            </ol>
        </div>
        
        <div class="section">
            <p><span class="section-title">üìé Important Links & Reports</span></p>
            <p>
                <strong><a href="${BUILD_URL}console">üìÑ View Full Console Output (MOST IMPORTANT)</a></strong><br/><br/>
                <strong>Test Reports:</strong><br/>
                <a href="${BUILD_URL}Backend_20Test_20Report/">üìä Backend Tests</a> | 
                <a href="${BUILD_URL}Frontend_20Test_20Report/">üß™ Frontend Tests</a><br/><br/>
                <strong>Coverage Reports:</strong><br/>
                <a href="${BUILD_URL}Backend_20Coverage_20Report/">üìä Backend Coverage</a> | 
                <a href="${BUILD_URL}Frontend_20Coverage_20Report/">üìà Frontend Coverage</a><br/><br/>
                <strong>Build Details:</strong><br/>
                <a href="${BUILD_URL}">üîó Build Details Page</a> | 
                <a href="${BUILD_URL}artifact/">üì¶ Artifacts</a>
            </p>
        </div>
        
        <div class="section">
            <p><span class="section-title">‚è∏Ô∏è Deployment Status</span></p>
            <p>
                ‚úÖ <strong>Good News:</strong> If this failure occurred during deployment, your previous version is still running due to automatic rollback.<br/>
                ‚ö†Ô∏è <strong>Still Required:</strong> Fix the issues and push fixes to deploy the corrected version.
            </p>
        </div>
    </div>
    
    <div class="footer">
        <p>This is an automated message from the Jenkins CI/CD Pipeline</p>
        <p>Build URL: <a href="${BUILD_URL}">${BUILD_URL}</a></p>
        <p>Contact your DevOps team if you need assistance investigating this failure.</p>
    </div>
</body>
</html>
